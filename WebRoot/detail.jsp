<%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%><%@ page import="entity.Items"%><%@ page import="dao.ItemsDAO"%><%@ page import="util.listHelper" %><%String path = request.getContextPath();String basePath = request.getScheme()+"://"+request.getServerName()+":"+request.getServerPort()+path+"/";%><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><base href="<%=basePath%>"><title>商品详情</title><meta http-equiv="pragma" content="no-cache"><meta http-equiv="cache-control" content="no-cache"><meta http-equiv="expires" content="0"><meta http-equiv="keywords" content="keyword1,keyword2,keyword3"><meta http-equiv="description" content="This is my page"><!--	<link rel="stylesheet" type="text/css" href="styles.css">	-->	<link href="css/main.css" rel="stylesheet" type="text/css">	<script type="text/javascript" src="js/lhgcore.js"></script>	<script type="text/javascript" src="js/lhgdialog.js"></script>	<script type="text/javascript">		function selflog_show(id){			var num = document.getElementById("number").value;			J.dialog.get({				id:'Johnathan_create',				title:'添加成功',				width:600,				height:400,				link:'<%=path %>/servlet/CartServlet?id=' + id + '&num=' + num + '&action=add',				cover:true			});		}		function add(){			var num = parseInt(document.getElementById("number").value);			if(num<100){				document.getElementById("number").value = ++ num;			}		}				function sub(){			var num = parseInt(document.getElementById("number").value);			if(num>1){				document.getElementById("number").value = -- num;			}		}	</script>	<style type="text/css">hr{	border-color:FF7F00;}div {	float: left;	margin-left:30px;	margin-right:30px;	margin-top: 5px;	margin-bottom: 5px;}div dd {    margin：0px;	font-size: 10pt;}div dd.dd_name {	color: blue;}div dd.dd_city {	color: #001;}div dd.dd_price {	color: red;}div #cart{	margin:0px auto;	text-align: right;}span{	padding:0 2px;border:1px #c0c0c0 solid;cursor;pointer;}a{	text-decoration:none;}</style></head><body>	<h1>商品详情</h1>	<a href="market.jsp">首页</a> >> <a href="market.jsp">商品列表</a>	<hr>	<center>		<table width="750" height="60" cellpadding="0" cellspacing="0" border="0">			<tr>		<% 		ItemsDAO dao = new ItemsDAO(); 		Items item = dao.getById(Integer.parseInt(request.getParameter("id"))); 		System.out.println(item.toString()); 	    if(item!=null){ 	 %>			<td width="70%" valign="top">				<table>					<tr>						<td rowspan="5"><img src="images/<%=item.getPicture() %>"							width="200" height=160 />						</td>					</tr>					<tr>						<td>						<B><%=item.getName() %></B>						</td>					</tr>					<tr>						<td>产地：<%=item.getCity() %></td>					</tr>					<tr>						<td>价格：<%=item.getPrice() %></td>					</tr>					<tr>						<td>购买数量:						<span id="sub" onclick="sub();">-</span>						<input type="text" id="number" name="number" value="1" size="2">						<span id="add" onclick="add();">+</span>						</td>					</tr>				</table>					<div id="cart">						<img src="images/buy_now.png">						<a href="javascript:selflog_show(<%=item.getId() %>)"><img src="images/in_cart.png"></a>						<a href="servlet/CartServlet?action=show"><img src="images/view_cart.jpg"></a>					</div>											<%	}	 %>	 </td>	 <%	  	String list ="";	  	Cookie[] cookies = request.getCookies();	  	if(cookies!=null && cookies.length>0){	  		for(Cookie c:cookies){	  			if(c.getName().equals("listViewCookie")){	  				System.out.println("找到该cookie");	  				list = c.getValue();	  			}	  		}	  	}	  	if(listHelper.isContained(list, item.getId())){	  	}else{	  		list = item.getId() + "," + list;	  	}	  	System.out.println("list:"+list);	  	String[] listitems = list.split(",");	  	if(listitems.length>5){	  		list = listHelper.trim(list);	  	}	  	Cookie cookie = new Cookie("listViewCookie",list);	  	response.addCookie(cookie);	  %>	<td width="30%" bgcolor="#EEE" align="center"><br>	  <b>最近浏览过的商品</b>	  <%	  	ArrayList<Items> items = dao.getViewList(list);	  	if(items!=null && items.size()>0){	  		for(Items it:items){	   %>	   <div>	   <dl>	   		<dt>	   		  <img src="images/<%=it.getPicture() %>" width="120" height="90" border="1" />	   		</dt>	   		<dd class="dd_name"><%=it.getName() %></dd>	   		<dd class="dd_city">产地：<%=it.getCity() %></dd>	   		<dd class="dd_price">价格：<%=it.getPrice() %>¥</dd>	   </dl>	   </div>	  <%	  }	  }	   %>	 </td></tr></table>	</center>	</body></html>